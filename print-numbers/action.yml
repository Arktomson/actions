name: 'Print Numbers'
description: 'æ‰“å°ä»1åˆ°nçš„æ•°å­— - ç”¨äºæµ‹è¯•GitHub Action'

branding:
  icon: 'hash'
  color: 'green'

inputs:
  number:
    description: 'è¦æ‰“å°åˆ°çš„æ•°å­—n'
    required: true
    default: '10'
  prefix:
    description: 'æ¯è¡Œæ•°å­—çš„å‰ç¼€'
    required: false
    default: 'Number: '
  format:
    description: 'è¾“å‡ºæ ¼å¼ (list, json, csv)'
    required: false
    default: 'list'

runs:
  using: 'composite'
  steps:
    - name: éªŒè¯è¾“å…¥
      shell: bash
      run: |
        if ! [[ "${{ inputs.number }}" =~ ^[0-9]+$ ]]; then
          echo "âŒ é”™è¯¯ï¼šnumber å¿…é¡»æ˜¯æ­£æ•´æ•°"
          exit 1
        fi
        
        if [[ "${{ inputs.number }}" -gt 1000 ]]; then
          echo "âŒ é”™è¯¯ï¼šnumber ä¸èƒ½è¶…è¿‡1000"
          exit 1
        fi
        
        echo "âœ… è¾“å…¥éªŒè¯é€šè¿‡ï¼šå°†æ‰“å° 1 åˆ° ${{ inputs.number }}"
        
    - name: æ‰“å°æ•°å­—
      id: print
      shell: bash
      run: |
        NUMBER=${{ inputs.number }}
        PREFIX="${{ inputs.prefix }}"
        FORMAT="${{ inputs.format }}"
        
        echo "ğŸ”¢ å¼€å§‹æ‰“å°æ•°å­—..."
        echo "ğŸ“‹ é…ç½®ï¼š"
        echo "  - æ•°å­—èŒƒå›´: 1 åˆ° $NUMBER"
        echo "  - å‰ç¼€: '$PREFIX'"
        echo "  - æ ¼å¼: $FORMAT"
        echo ""
        
        case $FORMAT in
          "json")
            echo "ğŸ“„ JSON æ ¼å¼è¾“å‡ºï¼š"
            echo -n '{"numbers": ['
            for ((i=1; i<=NUMBER; i++)); do
              if [[ $i -eq 1 ]]; then
                echo -n "$i"
              else
                echo -n ", $i"
              fi
            done
            echo ']}'
            
            # è®¾ç½®è¾“å‡º
            RESULT_JSON='{"numbers": ['
            for ((i=1; i<=NUMBER; i++)); do
              if [[ $i -eq 1 ]]; then
                RESULT_JSON="${RESULT_JSON}$i"
              else
                RESULT_JSON="${RESULT_JSON}, $i"
              fi
            done
            RESULT_JSON="${RESULT_JSON}]}"
            echo "result=$RESULT_JSON" >> $GITHUB_OUTPUT
            ;;
            
          "csv")
            echo "ğŸ“„ CSV æ ¼å¼è¾“å‡ºï¼š"
            CSV_RESULT=""
            for ((i=1; i<=NUMBER; i++)); do
              if [[ $i -eq 1 ]]; then
                CSV_RESULT="$i"
              else
                CSV_RESULT="${CSV_RESULT},$i"
              fi
            done
            echo "$CSV_RESULT"
            echo "result=$CSV_RESULT" >> $GITHUB_OUTPUT
            ;;
            
          *)
            echo "ğŸ“„ åˆ—è¡¨æ ¼å¼è¾“å‡ºï¼š"
            LIST_RESULT=""
            for ((i=1; i<=NUMBER; i++)); do
              echo "${PREFIX}$i"
              if [[ -z "$LIST_RESULT" ]]; then
                LIST_RESULT="$i"
              else
                LIST_RESULT="${LIST_RESULT} $i"
              fi
            done
            echo "result=$LIST_RESULT" >> $GITHUB_OUTPUT
            ;;
        esac
        
        echo "count=$NUMBER" >> $GITHUB_OUTPUT
        
    - name: åˆ›å»ºæ‘˜è¦
      shell: bash
      run: |
        echo "## ğŸ”¢ æ•°å­—æ‰“å°å®Œæˆ" >> $GITHUB_STEP_SUMMARY
        echo "- **èŒƒå›´**: 1 åˆ° ${{ inputs.number }}" >> $GITHUB_STEP_SUMMARY
        echo "- **æ€»æ•°**: ${{ steps.print.outputs.count }} ä¸ªæ•°å­—" >> $GITHUB_STEP_SUMMARY
        echo "- **æ ¼å¼**: ${{ inputs.format }}" >> $GITHUB_STEP_SUMMARY
        echo "- **å‰ç¼€**: '${{ inputs.prefix }}'" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        
        if [[ "${{ inputs.number }}" -le 20 ]]; then
          echo "### ğŸ“‹ è¾“å‡ºé¢„è§ˆ" >> $GITHUB_STEP_SUMMARY
          echo '```' >> $GITHUB_STEP_SUMMARY
          echo "${{ steps.print.outputs.result }}" >> $GITHUB_STEP_SUMMARY
          echo '```' >> $GITHUB_STEP_SUMMARY
        else
          echo "### ğŸ“‹ è¾“å‡ºé¢„è§ˆ (å‰10ä¸ªæ•°å­—)" >> $GITHUB_STEP_SUMMARY
          echo '```' >> $GITHUB_STEP_SUMMARY
          for ((i=1; i<=10; i++)); do
            echo "${{ inputs.prefix }}$i"
          done >> $GITHUB_STEP_SUMMARY
          echo "... (è¿˜æœ‰ $((${{ inputs.number }} - 10)) ä¸ªæ•°å­—)" >> $GITHUB_STEP_SUMMARY
          echo '```' >> $GITHUB_STEP_SUMMARY
        fi
        
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "âœ… ä»»åŠ¡å®Œæˆæ—¶é—´: $(date -u +'%Y-%m-%d %H:%M:%S UTC')" >> $GITHUB_STEP_SUMMARY